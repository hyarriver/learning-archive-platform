# 开发计划与里程碑

## 阶段一：核心功能（MVP）✅ 必须实现

### 1.1 项目基础搭建 (1-2天)
- [x] 项目结构创建
- [ ] 技术栈选型确认
- [ ] 环境配置（Python、依赖管理）
- [ ] 数据库初始化脚本
- [ ] 基础配置文件

### 1.2 爬虫模块 (3-5天)
- [ ] 基础爬虫框架（BaseCrawler）
- [ ] 网页爬虫实现（requests + BeautifulSoup）
- [ ] 视频字幕爬虫（yt-dlp集成）
- [ ] 内容解析器（HTML清理、结构提取）
- [ ] 单元测试与错误处理

### 1.3 Markdown转换模块 (2-3天)
- [ ] HTML转Markdown（html2text/pandoc）
- [ ] 目录生成（TOC）
- [ ] 标签提取（关键词/标题）
- [ ] 摘要生成（首段/前N句）
- [ ] 代码块与表格保留验证

### 1.4 文件存储模块 (2-3天)
- [ ] 文件系统组织结构
- [ ] 文件保存逻辑
- [ ] 版本管理（版本号、历史保留）
- [ ] 文件哈希计算（去重）
- [ ] 数据库索引更新

### 1.5 任务调度模块 (1-2天)
- [ ] APScheduler集成
- [ ] 定时任务配置（每日0点）
- [ ] 手动触发接口
- [ ] 任务执行日志

### 1.6 用户认证模块 (2-3天)
- [ ] 用户表设计与初始化
- [ ] 密码加密（bcrypt）
- [ ] JWT Token生成与验证
- [ ] 登录接口
- [ ] 中间件：权限验证

### 1.7 文件管理API (2-3天)
- [ ] 文件列表接口（分页、筛选）
- [ ] 文件详情接口（内容读取）
- [ ] 文件下载接口
- [ ] 上传接口（Multipart）
- [ ] 版本历史查询

### 1.8 前端基础 (3-4天)
- [ ] 登录页面
- [ ] 文件列表页面
- [ ] 文件详情/预览页面
- [ ] 上传功能界面
- [ ] 响应式布局（移动端适配）

**阶段一总计：16-25天**

---

## 阶段二：稳定性与体验优化

### 2.1 采集稳定性 (2-3天)
- [ ] 重试机制
- [ ] 错误隔离与日志
- [ ] 采集源配置管理界面
- [ ] 采集日志查看

### 2.2 版本管理优化 (1-2天)
- [ ] 版本对比功能
- [ ] 版本回滚功能
- [ ] 差异版本存储（可选）

### 2.3 性能优化 (2-3天)
- [ ] 异步采集（多源并行）
- [ ] 数据库索引优化
- [ ] 前端懒加载与分页
- [ ] 缓存策略

### 2.4 用户体验 (2-3天)
- [ ] 加载状态提示
- [ ] 错误提示优化
- [ ] 文件搜索（简单文本搜索）
- [ ] 标签筛选

**阶段二总计：7-11天**

---

## 阶段三：扩展功能（可选）

### 3.1 高级功能
- [ ] 全文搜索（SQLite FTS）
- [ ] 导出功能（PDF、ZIP）
- [ ] RSS源支持
- [ ] 多语言字幕合并优化

### 3.2 管理与监控
- [ ] 后台管理界面
- [ ] 采集统计图表
- [ ] 存储使用统计
- [ ] 日志查看界面

**阶段三总计：根据需求决定**

---

## MVP最小化实现路径

### 最简MVP (10-12天)
聚焦核心流程，忽略高级特性：

1. **基础框架** (1天)
   - FastAPI + SQLite + 基础路由

2. **简单爬虫** (3天)
   - 单一网页爬虫（博客文章）
   - HTML转Markdown（html2text）

3. **存储与版本** (2天)
   - 文件保存
   - 简单版本号管理

4. **任务调度** (1天)
   - APScheduler每日执行

5. **用户与API** (2天)
   - 简单登录（硬编码1个用户）
   - 文件列表/下载API

6. **前端** (2天)
   - 登录页 + 文件列表页
   - 基础样式

### 完整MVP (16-25天)
包含阶段一所有功能。

---

## 开发优先级建议

### P0（必须）
- 网页爬虫 + Markdown转换
- 文件存储 + 版本管理
- 定时任务执行
- 用户登录
- 文件列表/下载

### P1（重要）
- 视频字幕采集
- 采集源配置管理
- 错误处理与日志
- 移动端适配

### P2（优化）
- 标签与摘要
- 上传功能
- 版本对比
- 搜索功能

### P3（可选）
- AI摘要
- 全文搜索
- 导出功能
- 管理后台

---

## 风险点与应对

### 风险1：爬虫失效
- **应对**: 接受失败，记录日志，支持手动补采
- **缓解**: 使用多种解析策略，降低单点依赖

### 风险2：转换质量不佳
- **应对**: 使用成熟库（pandoc），人工校验样本
- **缓解**: 支持原始HTML备份

### 风险3：存储膨胀
- **应对**: 定期归档，只保留差异版本
- **缓解**: 监控存储使用，设置上限告警

### 风险4：开发周期超预期
- **应对**: 采用最简MVP先行，迭代优化
- **缓解**: 先实现单一来源（如博客），再扩展

---

## 测试策略

### 单元测试
- 爬虫解析器
- Markdown转换
- 版本管理逻辑

### 集成测试
- 采集流程端到端
- API接口测试

### 手动测试
- 多源采集验证
- 多端访问验证
- 边界情况（大文件、特殊字符）

---

## 上线检查清单

- [ ] 数据库备份机制
- [ ] 日志轮转配置
- [ ] 环境变量配置
- [ ] 定时任务验证
- [ ] 用户账号创建
- [ ] 采集源配置
- [ ] 前端部署验证
- [ ] 移动端访问测试
- [ ] 性能基准测试
- [ ] 错误监控设置
